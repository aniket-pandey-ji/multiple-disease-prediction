'use client';

import { useState } from "react";
import { Input } from "@/components/ui/input";
import { Button } from "@/components/ui/button";
import { Card, CardContent } from "@/components/ui/card";
import { Tabs, TabsList, TabsTrigger, TabsContent } from "@/components/ui/tabs";
import { Progress } from "@/components/ui/progress";

interface RiskItem {
  symptom: string;
    risk: number;
    }

    interface PredictionResult {
      disease: string;
        confidence: number;
          severity: string;
            topRisks: RiskItem[];
            }

            export default function DiseasePredictor() {
              const [formData, setFormData] = useState({
                  age: "",
                      gender: "",
                          symptoms: "",
                              lifestyle: ""
                                });

                                  const [result, setResult] = useState<PredictionResult | null>(null);
                                    const [tab, setTab] = useState("form");

                                      const handleChange = (e: React.ChangeEvent<HTMLInputElement>) => {
                                          setFormData({ ...formData, [e.target.name]: e.target.value });
                                            };

                                              const handlePredict = () => {
                                                  setResult({
                                                        disease: "Diabetes",
                                                              confidence: 92,
                                                                    severity: "High",
                                                                          topRisks: [
                                                                                  { symptom: "Frequent urination", risk: 80 },
                                                                                          { symptom: "Fatigue", risk: 75 },
                                                                                                  { symptom: "Weight loss", risk: 70 }
                                                                                                        ]
                                                                                                            });
                                                                                                                setTab("result");
                                                                                                                  };

                                                                                                                    return (
                                                                                                                        <div className="min-h-screen p-6 bg-gray-900 text-white">
                                                                                                                              <h1 className="text-3xl font-bold text-blue-400 mb-6">Multiple Disease Prediction System</h1>

                                                                                                                                    <Tabs defaultValue="form" value={tab} onValueChange={setTab} className="w-full">
                                                                                                                                            <TabsList className="bg-gray-800 mb-4">
                                                                                                                                                      <TabsTrigger value="form">Patient Form</TabsTrigger>
                                                                                                                                                                <TabsTrigger value="result" disabled={!result}>Prediction Result</TabsTrigger>
                                                                                                                                                                          <TabsTrigger value="ranking" disabled={!result}>Risk Breakdown</TabsTrigger>
                                                                                                                                                                                  </TabsList>

                                                                                                                                                                                          {/* FORM TAB */}
                                                                                                                                                                                                  <TabsContent value="form">
                                                                                                                                                                                                            <Card className="bg-gray-800">
                                                                                                                                                                                                                        <CardContent className="space-y-4">
                                                                                                                                                                                                                                      <h2 className="text-xl font-semibold text-white">Enter Patient Details</h2>
                                                                                                                                                                                                                                                    <div className="grid grid-cols-2 gap-4">
                                                                                                                                                                                                                                                                    <Input name="age" placeholder="Age" value={formData.age} onChange={handleChange} />
                                                                                                                                                                                                                                                                                    <Input name="gender" placeholder="Gender (Male/Female)" value={formData.gender} onChange={handleChange} />
                                                                                                                                                                                                                                                                                                    <Input name="lifestyle" placeholder="Lifestyle (e.g., Smoker, Active)" value={formData.lifestyle} onChange={handleChange} />
                                                                                                                                                                                                                                                                                                                    <Input name="symptoms" placeholder="Symptoms (comma separated)" value={formData.symptoms} onChange={handleChange} />
                                                                                                                                                                                                                                                                                                                                  </div>
                                                                                                                                                                                                                                                                                                                                                <Button onClick={handlePredict}>Predict Disease</Button>
                                                                                                                                                                                                                                                                                                                                                            </CardContent>
                                                                                                                                                                                                                                                                                                                                                                      </Card>
                                                                                                                                                                                                                                                                                                                                                                              </TabsContent>

                                                                                                                                                                                                                                                                                                                                                                                      {/* RESULT TAB */}
                                                                                                                                                                                                                                                                                                                                                                                              <TabsContent value="result">
                                                                                                                                                                                                                                                                                                                                                                                                        <Card className="bg-green-800">
                                                                                                                                                                                                                                                                                                                                                                                                                    <CardContent className="space-y-2">
                                                                                                                                                                                                                                                                                                                                                                                                                                  <h3 className="text-lg font-semibold">Prediction Result</h3>
                                                                                                                                                                                                                                                                                                                                                                                                                                                <p>Disease: <strong>{result?.disease}</strong></p>
                                                                                                                                                                                                                                                                                                                                                                                                                                                              <p>Confidence: <strong>{result?.confidence}%</strong></p>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                            <p>Severity Level: <strong>{result?.severity}</strong></p>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          <Progress value={result?.confidence} className="h-2 bg-gray-700" />
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      </CardContent>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                </Card>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        </TabsContent>

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                {/* RISK BREAKDOWN TAB */}
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <TabsContent value="ranking">
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  <Card className="bg-gray-800">
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              <CardContent className="space-y-4">
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            <h3 className="text-lg font-semibold">Top Risk Symptoms</h3>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          {result?.topRisks.map((item, index) => (
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          <div key={index}>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            <p>{item.symptom}</p>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              <Progress value={item.risk} className="h-2 bg-blue-700" />
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              </div>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            ))}
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        </CardContent>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  </Card>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          </TabsContent>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                </Tabs>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    </div>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      );
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      }